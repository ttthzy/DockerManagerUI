<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>{{.title}}</title>

  <link rel="stylesheet" type="text/css" href="/js/semanticUI/semantic.min.css">

  <script src="/js/jquery/jquery-1.12.1.min.js" charset="utf-8"></script>
  <script src="/js/semanticUI/semantic.min.js"></script>

  <style>
    body {
      padding: 1em;
    }
  </style>

</head>

<body>


    <div class="ui pointing menu">
      <a class="item">首页 </a>
      <a class="item active">镜像管理 </a>
      <a class="item">容器管理 </a>
      <a class="item">仓库配置 </a>
      <a class="item">个人中心 </a>
      <div class="right menu">
        <div class="item">
          <div class="ui transparent icon input">
            <input type="text" placeholder="检索本地镜像...">
            <i class="search link icon"></i>
          </div>
        </div>
      </div>
    </div>


  <div class="ui segment">
    <!-- HTML to write -->
    <div class="ui one column relaxed grid">

      <div class="column">
        <table id="tb_dockerimagelist" class="ui selectable celled right aligned table">
          <thead class="left aligned">
            <tr>
              <th>排序</th>
              <th>镜像Tag</th>
              <th>大小</th>
              <th>创建时间</th>
              <th>操作</th>
            </tr>
          </thead>

          <tbody>

          </tbody>

        </table>
        </table>
      </div>


    </div>


  </div>



<div class="ui segment">
  <div class="ui form">

        <div id="div_imageinfo"></div>

  </div>
</div>


  </form>

</body>

<script type="text/javascript">
  $(document).ready(function() {
    GetImages();
  })

  /// 获取所有镜像
  function GetImages() {
    $.ajax({
      url: "/api/docker/getimages",
      type: 'GET',
      success: function(jsondata) {
        console.log(jsondata);

        if (jsondata.message == "ok") {

          var udata = JSON.parse(jsondata.data);

          $("#tb_dockerimagelist tbody").html("");

          if (jsondata.data != "null") {

            for (var i = 0, l = udata.length; i < udata.length; i++) {
              var tr = "<tr class=\"left aligned\">";
              tr += "<td><div class=\"ui ribbon label\">" + i + "</div></td>";
              tr += "<td>" + udata[i].RepoTags + "</td>";
              tr += "<td>" + bytesToSize(udata[i].VirtualSize) + "</td>";
              tr += "<td>" + getLocalTime(udata[i].Created) + "</td>";

              tr += "<td><div class=\"ui buttons\"><button class=\"ui positive button\">建容</button><div class=\"or\"></div><button class=\"ui  button\">删除</button><div class=\"or\"></div><button class=\"ui blue button\">标签</button></div></td>";

              tr += "</tr>";
              $("#tb_dockerimagelist tbody").append(tr);
            }

          }

        }
      }
    });
  }


  function bytesToSize(bytes) {
    if (bytes === 0) return '0 B';

    var k = 1024;

    sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];

    i = Math.floor(Math.log(bytes) / Math.log(k));
    numbyte = (bytes / Math.pow(k, i));

    return numbyte.toPrecision(3) + ' ' + sizes[i];
    //toPrecision(3) 后面保留一位小数，如1.0GB                                                                                                                  //return (bytes / Math.pow(k, i)).toPrecision(3) + ' ' + sizes[i];
  }

  function getLocalTime(nS) {
    return new Date(parseInt(nS) * 1000).toLocaleString().
    replace("/", "-").
    replace("/", "-").
    replace(/上/g, " ").
    replace(/下/g, " ").
    replace(/午/g, " ").
    replace(/年|月/g, "-").
    replace(/日/g, " ");
  }
</script>

</html>
